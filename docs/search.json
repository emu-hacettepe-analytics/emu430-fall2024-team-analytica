[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Team XXX",
    "section": "",
    "text": "This is our project webpage.\nPlease stay tuned to follow our project activities.\nThis is our template.\n\nTeam Members\n\nEdin_Džeko\nDušan Tadić\nFrederico Rodrigues de Paula Santos\nSebastian Szymański\n\n\n\nProject Topic\n\n\nData Set\n\n\n\n\n Back to top"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "analysis.html",
    "href": "analysis.html",
    "title": "Analysis",
    "section": "",
    "text": "About this site\n\ndata_new &lt;- read_excel(\"izbb-kaza-ariza-verileri.xlsx\")\ndata_2023 &lt;- data_new %&gt;%\n  mutate(TARIH = as.Date(TARIH, format = \"%Y-%m-%d\")) %&gt;%  # Changing date format to yyyy-mm-dd \n  filter(year(TARIH) == 2023)\ndata_2023\n\n# A tibble: 6,366 x 7\n   TARIH      CADDE                    ISTIKAMET KONUM TUR   KAZA_ZAMANI        \n   &lt;date&gt;     &lt;chr&gt;                    &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt;             \n 1 2023-01-01 Fevzipaşa Bulvarı        Basmane   Çank~ Yara~ 1899-12-31 04:47:00\n 2 2023-01-01 Yeşildere Caddesi        Karabağl~ Atat~ Yara~ 1899-12-31 10:56:00\n 3 2023-01-01 Haydar Aliyev Bulvarı    Merkez    Mari~ Madd~ 1899-12-31 15:12:00\n 4 2023-01-01 Altınyol Caddesi         Merkez    DGM ~ Zinc~ 1899-12-31 15:39:00\n 5 2023-01-01 Mustafa Kemal Sahil Bul~ Marina    Mari~ Madd~ 1899-12-31 18:11:00\n 6 2023-01-01 Caher Dudayev Bulvarı    Çiğli     Yapı~ Madd~ 1899-12-31 18:13:00\n 7 2023-01-02 Anadolu Caddesi          Merkez    Tura~ Madd~ 1899-12-31 08:12:00\n 8 2023-01-02 Mustafa Kemal Sahil Bul~ Alsancak  Fevz~ Yang~ 1899-12-31 08:32:00\n 9 2023-01-02 Akçay Caddesi            Merkez    Serb~ Arız~ 1899-12-31 08:40:00\n10 2023-01-02 Akçay Caddesi            Havalima~ Gazi~ Yara~ 1899-12-31 14:06:00\n# i 6,356 more rows\n# i 1 more variable: MUDAHALE_ZAMANI &lt;dttm&gt;\n\n\n\nBy using the “data_new” dataset, we created the “data_2023”.In this data set, we can see the accidents that occurred in 2023 filtered.\n\n\ndata_2023 &lt;- data_2023 %&gt;%\n  mutate(ISTIKAMET_SAYISI = as.numeric(factor(ISTIKAMET)))\ngrouped_data_2 &lt;- data_2023 %&gt;%\n  group_by(ISTIKAMET) %&gt;%  # İstikamete göre gruplama\n  summarise(Total_Accidents = n())\ngrouped_data_2\n\n# A tibble: 98 x 2\n   ISTIKAMET    Total_Accidents\n   &lt;chr&gt;                  &lt;int&gt;\n 1 1. Sanayi                  1\n 2 Adliye                     5\n 3 Akıncılar                  1\n 4 Alsancak                  72\n 5 Altındağ                   1\n 6 Altınyol                   1\n 7 Anıt                       1\n 8 Bahçelievler               3\n 9 Balçova                   20\n10 Basmane                   45\n# i 88 more rows\n\n\n\nBy making a grouping of the accidents that took place in 2023 according to the directions, we examined how many accidents were made in which direction.\n\n\nsorted_grouped_data &lt;- grouped_data_2 %&gt;%\n  arrange(desc(Total_Accidents))\nsorted_grouped_data\n\n# A tibble: 98 x 2\n   ISTIKAMET  Total_Accidents\n   &lt;chr&gt;                &lt;int&gt;\n 1 Merkez                1671\n 2 Bornova               1059\n 3 Gaziemir               773\n 4 Konak                  413\n 5 Çiğli                  350\n 6 Karabağlar             323\n 7 Marina                 312\n 8 Havalimanı             268\n 9 Karşıyaka              179\n10 Kemalpaşa              161\n# i 88 more rows\n\n\n\nWe have sorted the accident numbers by destination points.\n\n\nlibrary(ggplot2)\n\nggplot(sorted_grouped_data, aes(x = reorder(ISTIKAMET, Total_Accidents), y = Total_Accidents)) +\n  geom_bar(stat = \"identity\", fill = \"purple\", color = \"black\") +\n  coord_flip() +  \n  labs(title = \"Distribution of Accidents According to Directions (2023)\", x = \"Destination\", y = \"Frequency\") +\n  theme_minimal() +\n  theme(axis.text.y = element_text(size = 3))\n\n\n\n\n\n\n\n\n\nWe have created a bar plot showing the distribution according to directions using our data set, the accident numbers of which have already been sorted to decreasing order.We can see that the most accidents occur in Merkez ,Bornova, Gaziemir, Konak and Çiğli.\n\n\nlibrary(dplyr)\naccidents_date &lt;- data_2023 %&gt;%\n  group_by(TARIH) %&gt;%  \n  summarise(Accident_Number = n())\naccidents_date\n\n# A tibble: 365 x 2\n   TARIH      Accident_Number\n   &lt;date&gt;               &lt;int&gt;\n 1 2023-01-01               6\n 2 2023-01-02               9\n 3 2023-01-03              10\n 4 2023-01-04              12\n 5 2023-01-05              11\n 6 2023-01-06              24\n 7 2023-01-07               8\n 8 2023-01-08              13\n 9 2023-01-09              23\n10 2023-01-10              19\n# i 355 more rows\n\n\n\nWe created a data set named “accidents_date” showing how many accidents happened on what date.\n\n\nlibrary(dplyr)\nmost_accidents_date &lt;- accidents_date %&gt;%\n  filter(Accident_Number == max(Accident_Number)) %&gt;%  # The date(s) with most accidents\n  pull(TARIH)\nmost_accidents_date\n\n[1] \"2023-06-22\"\n\n\n\nWe found out which day the most accidents happened.It is 22 June of 2023.\n\n\nsorted_accidents_date &lt;-accidents_date %&gt;%\n  arrange(desc(Accident_Number))\n\nhead(sorted_accidents_date,10)\n\n# A tibble: 10 x 2\n   TARIH      Accident_Number\n   &lt;date&gt;               &lt;int&gt;\n 1 2023-06-22              40\n 2 2023-04-07              38\n 3 2023-03-03              37\n 4 2023-06-23              36\n 5 2023-07-28              36\n 6 2023-10-18              36\n 7 2023-03-22              35\n 8 2023-04-10              35\n 9 2023-06-21              33\n10 2023-06-16              32\n\n\n\nWe sorted these numbers in descending order and collect them in a data set named “sorted_accidents_date”. Here you can also see the ten days with the most accidents.\n\n\ndestination_accidents &lt;- data_2023 %&gt;%\n  filter(TARIH %in% most_accidents_date) %&gt;%  \n  group_by(ISTIKAMET) %&gt;%  #Grouping be destinations\n  summarise(Accident_Number = n()) %&gt;%  \n  arrange(desc(Accident_Number)) \ndestination_accidents\n\n# A tibble: 9 x 2\n  ISTIKAMET  Accident_Number\n  &lt;chr&gt;                &lt;int&gt;\n1 Merkez                  13\n2 Gaziemir                 8\n3 Bornova                  6\n4 Havalimanı               4\n5 Konak                    3\n6 Karabağlar               2\n7 Çiğli                    2\n8 Marina                   1\n9 Otogar                   1\n\n\n\nOn June 22, 2023, the day of the most accidents, we collected how many accidents were caused while going to which direction in the data set named “destination_accidents”.\n\n\nlibrary(ggplot2)\n\nggplot(destination_accidents, aes(x = reorder(ISTIKAMET, Accident_Number), y = Accident_Number)) +\n  geom_bar(stat = \"identity\", fill = \"brown\", color = \"black\") +\n  labs(title = \"Accidents According to Directions on the Dates with the Most Accidents\", x = \"Destination\", y = \"Number of Accidents\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nIn order to better see the distribution, we had a bar plot drawn according to the direction.As we saw in the previous bar plot, the first three directions are again “Merkez”,“Gaziemir” and “Bornova”.\n\n\nlibrary(dplyr)\ntop_5_most_accident_dates &lt;- accidents_date %&gt;%\n  arrange(desc(Accident_Number)) %&gt;%  \n  slice(1:5) %&gt;%  #Selecting the first 5 rows\n  pull(TARIH)\ntop_5_most_accident_dates\n\n[1] \"2023-06-22\" \"2023-04-07\" \"2023-03-03\" \"2023-06-23\" \"2023-07-28\"\n\n\n\nIn our studies that we have done so far, we have found that the number of accidents is usually higher in the same directions.To better understand this, we also examine the first five days with the most accidentsWith the help of this code, we learn about the five days with the most accidents.\n\n\ndestination_accidents_top_5 &lt;- data_2023 %&gt;%\n  filter(TARIH %in% top_5_most_accident_dates) %&gt;%  \n  group_by(ISTIKAMET) %&gt;%  \n  summarise(Accident_Number = n()) %&gt;%  # Calculating the accident number for each destination point.\n  arrange(desc(Accident_Number))\ndestination_accidents_top_5\n\n# A tibble: 23 x 2\n   ISTIKAMET  Accident_Number\n   &lt;chr&gt;                &lt;int&gt;\n 1 Merkez                  60\n 2 Bornova                 28\n 3 Gaziemir                28\n 4 Konak                   12\n 5 Marina                   9\n 6 Havalimanı               8\n 7 Çiğli                    8\n 8 Karabağlar               5\n 9 Karşıyaka                5\n10 Alsancak                 4\n# i 13 more rows\n\n\n\nWe have collected the distribution of the five most accident days according to the directions in the data set named “destination_accidents_top_5” and sorted them in descending order\n\n\naccidents_date_destination &lt;- data_2023 %&gt;%\n  filter(TARIH %in% top_5_most_accident_dates) %&gt;%  \n  group_by(TARIH, ISTIKAMET) %&gt;%  # Grouping by date and destination \n  summarise(Accident_Number = n()) %&gt;%  # Calculating the number of accidents for each group\n  arrange(TARIH, desc(Accident_Number))  \n\n`summarise()` has grouped output by 'TARIH'. You can override using the\n`.groups` argument.\n\naccidents_date_destination\n\n# A tibble: 59 x 3\n# Groups:   TARIH [5]\n   TARIH      ISTIKAMET  Accident_Number\n   &lt;date&gt;     &lt;chr&gt;                &lt;int&gt;\n 1 2023-03-03 Merkez                   9\n 2 2023-03-03 Bornova                  8\n 3 2023-03-03 Gaziemir                 7\n 4 2023-03-03 Marina                   3\n 5 2023-03-03 Otogar                   3\n 6 2023-03-03 Alsancak                 1\n 7 2023-03-03 Buca                     1\n 8 2023-03-03 Karabağlar               1\n 9 2023-03-03 Kemalpaşa                1\n10 2023-03-03 Çankaya                  1\n# i 49 more rows\n\n\n\nWith the help of this code, we have grouped the accidents on the five days with the most accidents according to the date and direction and sorted each date in descending order. and again, as we expected, the first three directions on three of the five days are “Merkez”, “Gaziemir”, “Bornova”, while the remaining two days “Merkez” and “Gaziemir” are in the first two places.\nThanks to this interactive table, you can Decipher the distribution of accidents according to directions in the first five days, where the most accidents occurred, by searching as you want.\n\n\ndates_together &lt;- bind_rows(date_list)\ndatatable(dates_together, options = list(pageLength = 10, scrollX = TRUE))\n\n\n\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "Data",
    "section": "",
    "text": "Data source: İzmir İli Arızalı, Kazalı Araç Verileri"
  },
  {
    "objectID": "data.html#libraries",
    "href": "data.html#libraries",
    "title": "Data",
    "section": "LIBRARIES",
    "text": "LIBRARIES\nlibrary(readxl)        # For reading Excel files\nlibrary(stringr)       # For string manipulation\nlibrary(dplyr)         # For data manipulation\nlibrary(lubridate)     # For date and time operations\nlibrary(ggplot2)       # For data visualization\nlibrary(DT)            # For user interaction"
  },
  {
    "objectID": "data.html#data-loading-and-pre-processing",
    "href": "data.html#data-loading-and-pre-processing",
    "title": "Data",
    "section": "DATA LOADING AND PRE-PROCESSING",
    "text": "DATA LOADING AND PRE-PROCESSING\n\n\nWarning: package 'readxl' was built under R version 4.4.2\n\n\nWarning: package 'stringr' was built under R version 4.4.2\n\n\nWarning: package 'dplyr' was built under R version 4.4.2\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\nWarning: package 'lubridate' was built under R version 4.4.2\n\n\n\nAttaching package: 'lubridate'\n\n\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union\n\n\nWarning: package 'ggplot2' was built under R version 4.4.2\n\n\nWarning: package 'DT' was built under R version 4.4.2\n\n\n\n# Turkish characters detection\nSys.setlocale(\"LC_ALL\", \"Turkish\")\n\nWarning in Sys.setlocale(\"LC_ALL\", \"Turkish\"): using locale code page other\nthan 65001 (\"UTF-8\") may cause problems\n\n\n\n# Loading the data set\ndata_original &lt;- read_excel(\"izbb-kaza-ariza-verileri.xlsx\")\n\n\nhead(data_original)\n\n# A tibble: 6 x 7\n  TARIH               CADDE            ISTIKAMET KONUM TUR   KAZA_ZAMANI        \n  &lt;dttm&gt;              &lt;chr&gt;            &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt;             \n1 2021-12-08 00:00:00 Havalimanı Şoşe~ Evka-5    Harm~ Madd~ 1899-12-31 17:57:00\n2 2021-12-06 00:00:00 Akçay Caddesi    Havalima~ Esba~ Arız~ 1899-12-31 07:27:00\n3 2021-12-09 00:00:00 Akçay Caddesi    Havalima~ Sarn~ Madd~ 1899-12-31 07:54:00\n4 2021-12-09 00:00:00 Akçay Caddesi    Havalima~ Serb~ Arız~ 1899-12-31 07:57:00\n5 2021-12-15 00:00:00 Yeşillik Caddesi Havalima~ Paşa~ Arız~ 1899-12-31 11:57:00\n6 2021-12-17 00:00:00 Akçay Caddesi    Havalima~ Esbaş Madd~ 1899-12-31 08:02:00\n# i 1 more variable: MUDAHALE_ZAMANI &lt;dttm&gt;\n\n\n\nstr(data_original)\n\ntibble [17,788 x 7] (S3: tbl_df/tbl/data.frame)\n $ TARIH          : POSIXct[1:17788], format: \"2021-12-08\" \"2021-12-06\" ...\n $ CADDE          : chr [1:17788] \"Havalimanı Şoşesi\" \"Akçay Caddesi\" \"Akçay Caddesi\" \"Akçay Caddesi\" ...\n $ ISTIKAMET      : chr [1:17788] \"Evka-5\" \"Havalimanı\" \"Havalimanı\" \"Havalimanı\" ...\n $ KONUM          : chr [1:17788] \"Harmandalı Meydanı\" \"Esbaş Alt Geçit\" \"Sarnıç Alt Geçit Üzeri\" \"Serbest Bölge Alt Geçit Öncesi\" ...\n $ TUR            : chr [1:17788] \"Maddi Hasarlı\" \"Arızalı\" \"Maddi Hasarlı\" \"Arızalı\" ...\n $ KAZA_ZAMANI    : POSIXct[1:17788], format: \"1899-12-31 17:57:00\" \"1899-12-31 07:27:00\" ...\n $ MUDAHALE_ZAMANI: POSIXct[1:17788], format: \"1899-12-31 18:14:00\" \"1899-12-31 07:41:00\" ...\n\n\n\n# How many NA in which column?\n\ncolSums(is.na(data_original))\n\n          TARIH           CADDE       ISTIKAMET           KONUM             TUR \n              0               0              16              14               0 \n    KAZA_ZAMANI MUDAHALE_ZAMANI \n              0            4400 \n\n\n\n# Delete NA ones in the ISTIKAMET column\n\ndata_new &lt;- data_original[!is.na(data_original$ISTIKAMET), ]\n\n\n# See unique destination names\n\nunique_istikamet &lt;- sort(unique(data_new$ISTIKAMET))\n\nprint(unique_istikamet)\n\n  [1] \"1. Sanayi\"            \"5. Sanayi\"            \"Adliye\"              \n  [4] \"Adnan Kahveci Köprü\"  \"Akıncılar\"            \"Alaybey\"             \n  [7] \"alsancak\"             \"Alsancak\"             \"Alsancak Gar\"        \n [10] \"Alsancak İstikameti\"  \"Altındağ\"             \"Altınyol\"            \n [13] \"Anıt\"                 \"Atakent\"              \"Atasanayi\"           \n [16] \"Ataşehir\"             \"Atatürk Stadyumu\"     \"Bahçelievler\"        \n [19] \"Balçova\"              \"Basmane\"              \"Bayraklı\"            \n [22] \"Bayramyeri\"           \"Beyazevler\"           \"bornova\"             \n [25] \"Bornova\"              \"Borsa\"                \"Borsa Kavşağı\"       \n [28] \"Bostanlı\"             \"Bozyaka\"              \"Buca\"                \n [31] \"Buca Heykel\"          \"Cumhuriyet\"           \"Cumhuriyet Meydanı\"  \n [34] \"Çankaya\"              \"Çeşme\"                \"Çevik Bir\"           \n [37] \"Çevre Yolu\"           \"Çevreyolu\"            \"Çiğli\"               \n [40] \"Çınarlı\"              \"Dokuz Çeşmeler\"       \"Egemak Kavşağı\"      \n [43] \"Eşrefpaşa\"            \"Evka-3\"               \"Evka-5\"              \n [46] \"F.Altay\"              \"Fahrettin altay\"      \"Fahrettin Altay\"     \n [49] \"Fuar\"                 \"Gaziemir\"             \"Gediz\"               \n [52] \"Gıda Çarşısı\"         \"Göztepe\"              \"Gündoğdu\"            \n [55] \"Gürçeşme\"             \"Güzelbahçe\"           \"Halit Ziya Bulvarı\"  \n [58] \"Halkapınar\"           \"Harmandalı\"           \"havalimanı\"          \n [61] \"Havalimanı\"           \"Heykel\"               \"Hipodrum\"            \n [64] \"İkiçeşmelik\"          \"İnciraltı\"            \"İnciraltı İstikameti\"\n [67] \"İskele\"               \"İşçievleri Kavşağı\"   \"Işıkkent\"            \n [70] \"İzmir\"                \"Kapılar\"              \"karabağlar\"          \n [73] \"Karabağlar\"           \"Karataş\"              \"Karşıa\"              \n [76] \"Karşıyaka\"            \"Kaymakkuyu\"           \"Kaynaklar\"           \n [79] \"Kemalpaş\"             \"kemalpaşa\"            \"Kemalpaşa\"           \n [82] \"Kemer\"                \"Kırıklar\"             \"Kısık\"               \n [85] \"konak\"                \"Konak\"                \"Konak Tüneli\"        \n [88] \"Koyundere\"            \"Köstence\"             \"Liman\"               \n [91] \"Liman D Kapısı\"       \"Lojmanlar\"            \"Mahvel\"              \n [94] \"Mahvel Kavşağı\"       \"Mai\"                  \"Manavkuyu\"           \n [97] \"Manisa\"               \"Marina\"               \"Mavibahçe\"           \n[100] \"Mavişehir\"            \"Meles\"                \"Menderes\"            \n[103] \"Menemen\"              \"Merkez\"               \"Montrö\"              \n[106] \"Mürselpaşa Bulvarı\"   \"Narlıdere\"            \"Nato\"                \n[109] \"Osman Kibar\"          \"Otoban\"               \"otogar\"              \n[112] \"Otogar\"               \"Örnekköy\"             \"Pınarbaşı\"           \n[115] \"Pınarbaşo\"            \"Sahil\"                \"Salhane\"             \n[118] \"Sanayi\"               \"Sarnıç\"               \"Sasalı\"              \n[121] \"Serbest Bölge\"        \"Smyrna\"               \"Soğukkuyu\"           \n[124] \"Stadyum\"              \"Şirinyer\"             \"Taşkent\"             \n[127] \"Teleferik\"            \"Tepecik\"              \"Tersane\"             \n[130] \"Tınaztepe\"            \"Torbalı\"              \"Turan\"               \n[133] \"Urla\"                 \"Üçkuyular\"            \"Üçkuyular Meydan\"    \n[136] \"Üçyo\"                 \"üçyol\"                \"Üçyol\"               \n[139] \"Yağhaneler\"           \"Yaşayanlar\"           \"Yeni Girne\"          \n[142] \"Yenişehir\"            \"Yeşildere\"            \"Yeşilova\"            \n[145] \"Yeşilyurt\"            \"Yıkık Kemer\"          \"Yıkıkkemer\"          \n[148] \"Yunuslar\"            \n\n# String edits in destination names\n\ndata_new$ISTIKAMET &lt;- gsub(\"Alsancak|Alsancak İstikameti|Alsancak Gar|alsancak\", \"Alsancak\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Buca|Buca Heykel\", \"Buca\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Konak|Konak Tüneli|Konak İstikameti\", \"Konak\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Kemalpaşa|kemalpaşa|Kemalpaş\", \"Kemalpaşa\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Havalimanı|havalimanı\", \"Havalimanı\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"İnciraltı|İnciraltı İstikameti\", \"İnciraltı\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Üçkuyular|Üçkuyular Meydan\", \"Üçkuyular\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Sarnıç|Sarniç\", \"Sarnıç\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Fahrettin Altay|F.Altay|Fahrettin altay\", \"Fahrettin Altay\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Tersane|Tersanesi\", \"Tersane\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Otogar|Otogar Meydanı\", \"Otogar\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Basmane|Basmane Gar\", \"Basmane\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Pınarbaşı|Pınarbaşo\", \"Pınarbaşı\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Üçyol|üçyol|Üçyo\", \"Üçyol\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Karabağlar|karabağlar\", \"Karabağlar\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Konak|konak\", \"Konak\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Gündoğdu|Gündoğdu Mahallesi\", \"Gündoğdu\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Mahvel|Mahvel Kavşağı\", \"Mahvel\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Beyazevler|Beyaz Evler\", \"Beyazevler\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Adliye|Adliye Kavşağı\", \"Adliye\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Harmandalı|Harmandali\", \"Harmandalı\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Yıkık Kemer|Yıkıkkemer|Yıkıkker\", \"Yıkıkkemer\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Karşıa\", \"Karşıyaka\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Liman D Kapısı\", \"Liman\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"otogar\", \"Otogar\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"bornova\", \"Bornova\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Mai\", \"Mustafa Kemal Sahil\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Borsa|Borsa Kavşağı\", \"Borsa\", data_new$ISTIKAMET)\ndata_new$ISTIKAMET &lt;- gsub(\"Çevre Yolu|Çevreyolu\", \"Çevreyolu\", data_new$ISTIKAMET)\n\n# Checking destination names\n\nunique_istikamet_new &lt;- sort(unique(data_new$ISTIKAMET))\n\nprint(unique_istikamet_new)\n\n  [1] \"1. Sanayi\"           \"5. Sanayi\"           \"Adliye\"             \n  [4] \"Adnan Kahveci Köprü\" \"Akıncılar\"           \"Alaybey\"            \n  [7] \"Alsancak\"            \"Altındağ\"            \"Altınyol\"           \n [10] \"Anıt\"                \"Atakent\"             \"Atasanayi\"          \n [13] \"Ataşehir\"            \"Atatürk Stadyumu\"    \"Bahçelievler\"       \n [16] \"Balçova\"             \"Basmane\"             \"Bayraklı\"           \n [19] \"Bayramyeri\"          \"Beyazevler\"          \"Bornova\"            \n [22] \"Borsa\"               \"Bostanlı\"            \"Bozyaka\"            \n [25] \"Buca\"                \"Cumhuriyet\"          \"Cumhuriyet Meydanı\" \n [28] \"Çankaya\"             \"Çeşme\"               \"Çevik Bir\"          \n [31] \"Çevreyolu\"           \"Çiğli\"               \"Çınarlı\"            \n [34] \"Dokuz Çeşmeler\"      \"Egemak Kavşağı\"      \"Eşrefpaşa\"          \n [37] \"Evka-3\"              \"Evka-5\"              \"Fahrettin Altay\"    \n [40] \"Fuar\"                \"Gaziemir\"            \"Gediz\"              \n [43] \"Gıda Çarşısı\"        \"Göztepe\"             \"Gündoğdu\"           \n [46] \"Gürçeşme\"            \"Güzelbahçe\"          \"Halit Ziya Bulvarı\" \n [49] \"Halkapınar\"          \"Harmandalı\"          \"Havalimanı\"         \n [52] \"Heykel\"              \"Hipodrum\"            \"İkiçeşmelik\"        \n [55] \"İnciraltı\"           \"İskele\"              \"İşçievleri Kavşağı\" \n [58] \"Işıkkent\"            \"İzmir\"               \"Kapılar\"            \n [61] \"Karabağlar\"          \"Karataş\"             \"Karşıyaka\"          \n [64] \"Kaymakkuyu\"          \"Kaynaklar\"           \"Kemalpaşa\"          \n [67] \"Kemer\"               \"Kırıklar\"            \"Kısık\"              \n [70] \"Konak\"               \"Koyundere\"           \"Köstence\"           \n [73] \"Liman\"               \"Lojmanlar\"           \"Mahvel\"             \n [76] \"Manavkuyu\"           \"Manisa\"              \"Marina\"             \n [79] \"Mavibahçe\"           \"Mavişehir\"           \"Meles\"              \n [82] \"Menderes\"            \"Menemen\"             \"Merkez\"             \n [85] \"Montrö\"              \"Mustafa Kemal Sahil\" \"Mürselpaşa Bulvarı\" \n [88] \"Narlıdere\"           \"Nato\"                \"Osman Kibar\"        \n [91] \"Otoban\"              \"Otogar\"              \"Örnekköy\"           \n [94] \"Pınarbaşı\"           \"Sahil\"               \"Salhane\"            \n [97] \"Sanayi\"              \"Sarnıç\"              \"Sasalı\"             \n[100] \"Serbest Bölge\"       \"Smyrna\"              \"Soğukkuyu\"          \n[103] \"Stadyum\"             \"Şirinyer\"            \"Taşkent\"            \n[106] \"Teleferik\"           \"Tepecik\"             \"Tersane\"            \n[109] \"Tınaztepe\"           \"Torbalı\"             \"Turan\"              \n[112] \"Urla\"                \"Üçkuyular\"           \"Üçyol\"              \n[115] \"Yağhaneler\"          \"Yaşayanlar\"          \"Yeni Girne\"         \n[118] \"Yenişehir\"           \"Yeşildere\"           \"Yeşilova\"           \n[121] \"Yeşilyurt\"           \"Yıkıkkemer\"          \"Yunuslar\"           \n\n\n\nunique_tur &lt;- sort(unique(data_new$TUR))\n\nprint(unique_tur)\n\n [1] \"Adli Vaka\"            \"Ağır Vasıta\"          \"Arızalı\"             \n [4] \"Asfalt Çalışması\"     \"Aşan Yükseklik\"       \"Bekleme\"             \n [7] \"Futbol Maçı\"          \"Heyelan\"              \"İzsu Çalışması\"      \n[10] \"Konteynır Devrilmesi\" \"maddi Hasarlı\"        \"Maddi Hasarlı\"       \n[13] \"MAddi Hasarlı\"        \"Ölümlü\"               \"Ölümlü Kaza\"         \n[16] \"Patlak Lastik\"        \"Perdeleme\"            \"Takla Atan\"          \n[19] \"Tramvay Kazası\"       \"Uygulama\"             \"Yakıt Bitimi\"        \n[22] \"Yakıtı Biten\"         \"Yanan Araç\"           \"Yangın\"              \n[25] \"yaralanmalı Kaza\"     \"Yaralanmalı Kaza\"     \"Yaya Yolu Çalışması\" \n[28] \"Yoğun Duman\"          \"Yol Yapım\"            \"Zincirleme Kaza\"     \n\n# String edits in accident type names\n\ndata_new$TUR &lt;- gsub(\"maddi Hasarlı|Maddi Hasarlı|MAddi Hasarlı\", \"Maddi Hasarlı\", data_new$TUR)\ndata_new$TUR &lt;- gsub(\"Ölümlü\", \"Ölümlü Kaza\", data_new$TUR)\ndata_new$TUR &lt;- gsub(\"Yakıtı Biten\", \"Yakıt Bitimi\", data_new$TUR)\ndata_new$TUR &lt;- gsub(\"Yangın\", \"Yanan Araç\", data_new$TUR)\ndata_new$TUR &lt;- gsub(\"yaralanmalı Kaza\", \"Yaralanmalı Kaza\", data_new$TUR)\n\n# Checking accident type names\n\nunique_tur_new &lt;- sort(unique(data_new$TUR))\n\nprint(unique_tur_new)\n\n [1] \"Adli Vaka\"            \"Ağır Vasıta\"          \"Arızalı\"             \n [4] \"Asfalt Çalışması\"     \"Aşan Yükseklik\"       \"Bekleme\"             \n [7] \"Futbol Maçı\"          \"Heyelan\"              \"İzsu Çalışması\"      \n[10] \"Konteynır Devrilmesi\" \"Maddi Hasarlı\"        \"Ölümlü Kaza\"         \n[13] \"Ölümlü Kaza Kaza\"     \"Patlak Lastik\"        \"Perdeleme\"           \n[16] \"Takla Atan\"           \"Tramvay Kazası\"       \"Uygulama\"            \n[19] \"Yakıt Bitimi\"         \"Yanan Araç\"           \"Yaralanmalı Kaza\"    \n[22] \"Yaya Yolu Çalışması\"  \"Yoğun Duman\"          \"Yol Yapım\"           \n[25] \"Zincirleme Kaza\"     \n\n\n\n# Calculate the number of data for each destination\n\ncounts &lt;- data_new %&gt;%\n  group_by(ISTIKAMET) %&gt;%\n  summarise(count = n())\n\n\n# Finding direction values with less than 5 data\n\nistikamet_to_remove &lt;- counts %&gt;%\n  filter(count &lt; 5) %&gt;%\n  pull(ISTIKAMET)\n\n# Delete them from the data set\n\ndata_new &lt;- data_new %&gt;%\n  filter(!ISTIKAMET %in% istikamet_to_remove)\n\n\n# Calculate the time between accident time and intervention time and add it as a new column\n\ndata_new$GECEN_SURE &lt;- difftime(data_new$MUDAHALE_ZAMANI, data_new$KAZA_ZAMANI, units = \"mins\")\n\n# Taking into account the day difference for interventions arriving after midnight\n\ndata_new &lt;- data_new %&gt;%\n  mutate(\n    GECEN_SURE = ifelse(\n      MUDAHALE_ZAMANI &lt; KAZA_ZAMANI, \n      difftime(MUDAHALE_ZAMANI + days(1), KAZA_ZAMANI, units = \"mins\"),\n      difftime(MUDAHALE_ZAMANI, KAZA_ZAMANI, units = \"mins\")\n    )\n  )\n\n\n# Calculate the average response time for each destination\n\ndata_new &lt;- data_new %&gt;%\n  group_by(ISTIKAMET) %&gt;%\n  mutate(ORTALAMA_GECEN_SURE = mean(GECEN_SURE, na.rm = TRUE))\n\n# Fill each NA value for GECEN_SURE with the average time of the direction it is connected to\n\ndata_new &lt;- data_new %&gt;%\n  mutate(GECEN_SURE = ifelse(is.na(GECEN_SURE), ORTALAMA_GECEN_SURE, GECEN_SURE))\n\nsum(is.na(data_new$GECEN_SURE))\n\n[1] 0"
  }
]